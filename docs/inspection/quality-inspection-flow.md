# 质检流程说明

## 1. 整体流程
1. 录音上传
2. 语音转文字
3. 质检分析
4. 结果展示

## 2. 页面交互
- 左侧列表：显示录音记录以及是否已质检
- 右侧内容：显示质检结果
- 操作按钮：进行质检操作，以及查看已质检结果

## 3. 数据流转
1. 前端调用 `/inspection/quality/submit` 接口
2. 后端处理：
   - 获取对话内容
   - 调用质检 API
   - 保存质检结果
   - 更新质检状态
3. 返回质检结果到前端展示

## 4. 相关表结构
- INSU_VOICE_RECORD: 录音记录表
- INSU_VOICE_DIALOG: 对话内容表
- INSU_VOICE_INSPECTION: 质检结果表

## 5. 待完善功能
1. ✅ 首先通过insu_voice_record表查询出所有的录音记录
2. 🔄 点击质检按钮，调用质检API
   - 2.1 ✅ 配置质检API参数
   - 2.2 🔄 调试质检提示语（Prompt）
     - ✅ 完善系统角色设定，增加具体评估要求
     - ✅ 优化JSON响应模板，增加性能分析和建议
     - ✅ 使用DIALOG_TEXT_ID作为对话引用标识
     - 🔄 测试提示语效果
   - 2.3 ⚠️ API响应解析问题
   - 2.4 前端展示优化
     - 左侧对话展示：聊天形式，按时间顺序展示
     - 右侧质检结果：违规条目可点击，通过DIALOG_TEXT_ID定位到左侧对应对话
     - 考虑添加对话高亮和自动滚动功能
3. 合并同一角色对话内容，上传至大模型
4. 获取质检结果
5. 质检结果需要展示在质检查询页面右侧，需要将质检结果转换为json字符串，保存到insu_voice_inspection表的INSPECTION_RESULT字段

