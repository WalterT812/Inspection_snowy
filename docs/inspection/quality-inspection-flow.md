# 质检流程说明

## 1. 整体流程
1. 录音上传
2. 语音转文字
3. 质检分析
4. 结果展示

## 2. 页面交互
- 左侧列表：显示录音记录以及是否已质检
- 右侧内容：显示质检结果
- 操作按钮：进行质检操作，以及查看已质检结果

## 3. 数据流转
1. 前端调用 `/inspection/quality/submit` 接口
2. 后端处理：
   - 获取对话内容
   - 调用质检 API
   - 保存质检结果
   - 更新质检状态
3. 返回质检结果到前端展示

## 4. 相关表结构
- INSU_VOICE_RECORD: 录音记录表
- INSU_VOICE_DIALOG: 对话内容表
- INSU_VOICE_INSPECTION: 质检结果表

## 5. 功能清单
1. ✅ 首先通过insu_voice_record表查询出所有的录音记录
2. ✅ 点击质检按钮，调用质检API
   - ✅ 配置质检API参数
   - ✅ 调试质检提示语（Prompt）
     - ✅ 完善系统角色设定，增加具体评估要求
     - ✅ 优化JSON响应模板，增加性能分析和建议
     - ✅ 使用DIALOG_TEXT_ID作为对话引用标识
     - ✅ 测试提示语效果
   - ✅ API响应解析问题
   - ✅ 前端展示优化
     - ✅ 左侧列表功能：
       - ✅ 基础列表展示
       - ✅ 质检按钮功能
       - ✅ 添加查看按钮，直接查看已保存的质检结果
     - ✅ 右侧质检结果展示：
       - ✅ 基础信息展示
       - ✅ 优化JSON结果展示
       - ✅ 添加加载动画
       - 🔄 违规条目可点击定位
3. ✅ 合并同一角色对话内容，上传至大模型
4. ✅ 获取质检结果
5. ✅ 质检结果保存到数据库

## 6. 使用说明
1. 质检操作：
   - 点击"质检"按钮开始质检
   - 等待质检完成，结果会自动显示在右侧
   - 质检完成后状态自动更新
2. 查看结果：
   - 点击"查看"按钮可以查看历史质检结果
   - 右侧会显示质检总结、分数和违规详情
3. 注意事项：
   - 已质检的录音不能重复质检
   - 未质检的录音不能查看结果

